#!/data/data/com.termux/files/usr/bin/sh


if [ "$#" != "0" ]; then
        echo 'usage: termux-info'
				echo 'Provides information about termux, and the current system. Helpful for debugging.'
        exit
fi



version() {
	if [ -e "$PREFIX/version" ]; then
		cat "$PREFIX/version"
	else
		echo '<0.40'
	fi
}
apps() {
	pm list packages -i | grep com.termux
}
updates() {
	apt update >/dev/null 2>&1
	updatable=$(apt list --upgradable 2>/dev/null | tail -n +2)
	if [ -z "$updatable" ];then
		echo "All packages up to date"
	else
		echo "$updatable"
	fi
}
sysinfo() {
	uname -a
}
output="Termux version:
$(version)
Installed Termux apps:
$(apps)
Updatable packages:
$(updates)
System information:
$(sysinfo)
"
echo "$output"
# Copy to clipboard (requires termux-api)
# use timeout in case termux-api is installed but the termux:api app is missing
echo "$output" | busybox timeout -t 3 termux-clipboard-set 2>/dev/null
busybox timeout -t 3 termux-toast "Information has been copied to the clipboard" 2>/dev/null
exit 0
